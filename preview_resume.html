{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Preview Resume</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f4f4f4;
      padding: 30px;
      color: #333;
    }
    .container {
      max-width: 900px;
      margin: auto;
      background: white;
      padding: 40px 30px;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
    }
    h1, h2, h3 {
      margin-top: 0;
      color: #222;
    }
    h3 {
      border-bottom: 2px solid #007bff;
      padding-bottom: 5px;
      margin-bottom: 15px;
    }
    .section {
      margin-bottom: 30px;
    }
    .info p {
      margin: 5px 0;
    }
    .info a {
      color: #007bff;
      text-decoration: none;
    }
    .info a:hover {
      text-decoration: underline;
    }
    ul {
      padding-left: 20px;
    }
    li {
      margin-bottom: 8px;
    }
    .experience, .project {
      margin-bottom: 15px;
    }
    .experience-title {
      font-weight: bold;
    }
    .experience-duration {
      font-style: italic;
      font-size: 0.95em;
      color: #666;
      margin-bottom: 5px;
    }
    .btn-download {
      display: inline-block;
      margin-top: 30px;
      text-align: center;
      padding: 12px 24px;
      font-size: 16px;
      background-color: #28a745;
      color: white;
      border-radius: 5px;
      text-decoration: none;
      transition: background 0.2s ease;
    }
    .btn-download:hover {
      background-color: #218838;
    }
  </style>
</head>
<body>

  <!-- Resume Content Container for PDF -->
  <div class="container" id="mn">
    <h1 style="text-align:center; font-size: 32px; margin-bottom: 20px;">{{ resume.name }}</h1>


    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
  
      <!-- Left: Name and Contact Info -->
      <div style="width: 70%;">
        <p><strong>Email:</strong> <a href="mailto:{{ resume.email }}">{{ resume.email }}</a></p>
        <p><strong>Phone:</strong> {{ resume.phone }}</p>
        <p><strong>LinkedIn:</strong> <a href="{{ resume.linkedin }}" target="_blank">{{ resume.linkedin }}</a></p>
        <p><strong>GitHub:</strong> <a href="{{ resume.github }}" target="_blank">{{ resume.github }}</a></p>
        <p><strong>Portfolio:</strong> <a href="{{ resume.portfolio }}" target="_blank">{{ resume.portfolio }}</a></p>
      </div>

      <!-- Right: Photo -->
      {% if resume.photo %}
      <div style="width: 30%; text-align: right; padding-right: 50px;">
        <img src="{{ resume.photo.url }}" alt="Profile Photo"
             style="width: 150px; height: 140px; border-radius: 50%; object-fit: cover; border: 2px solid #000;">
      </div>
      {% endif %}

    </div>


    {% if resume.summary %}
    <div class="section" style="margin-top: 30px;">
      <h3>Summary</h3>
      <p>{{ resume.summary }}</p>
    </div>
    {% endif %}

    {% if skills %}
    <div class="section">
      <h3>Skills</h3>
      <ul>
        {% for skill in skills %}
          <li>{{ skill.name }}</li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}

    {% if experiences %}
    <div class="section">
      <h3>Experience</h3>
      <ul>
        {% for experience in experiences %}
          <li>
            <span class="experience-title">{{ experience.title }} at {{ experience.company }}</span><br>
            <span class="experience-duration">{{ experience.duration }}</span><br>
            {{ experience.description }}
          </li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}

    {% if projects %}
    <div class="section">
      <h3>Projects</h3>
      <ul>
        {% for project in projects %}
          <li>
            <strong>{{ project.title }}</strong><br>
            {{ project.description }}<br>
            {% if project.link %}
              <a href="{{ project.link }}" target="_blank">ðŸ”— View Project</a>
            {% endif %}
          </li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}

    {% if achievements %}
    <div class="section">
      <h3>Achievements</h3>
      <ul>
        {% for achievement in achievements %}
          <li>{{ achievement.title }}</li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}

  </div>

  <!-- Download Button -->
  <div style="text-align: center;">
    <button onclick="generatePDF('mn')" type="button" class="btn-download">ðŸ“„ Download PDF</button>
  </div>

  <!-- PDF Generator Scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
  <script>
    function generatePDF(containerId) {
      const container = document.getElementById(containerId);
      const pdfOptions = {
        margin: 10,
        filename: 'resume.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
      };
      html2pdf().from(container).set(pdfOptions).save();
    }
  </script>

</body>
</html>
